<!DOCTYPE html>
<html>
 <!-- Per insertar Codi, podeu utilitzar http://hilite.me/ -->
    <head>
        <title>Data Viz. Big Data UAB</title>
        <link href="styles/style.css" rel="stylesheet" type="text/css">
        <!-- Si voleu canviar la font o algun altre paràmetre, ho podeu fer aquí, o al CSS -->
        <style>
            body {
                background-color: white;
            }
            .container {
                max-width: 1100px;
            }
            h1, h2, h3, h4, h5, p {
                color:black;
            }
            a:link {
                color:brown;
            }
            a:visited {
                color: #555a5e;
            }
            center img{
                margin: 0 auto;
                max-width: 50%;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
            <p>Autors: Miquel Coll, Alexander Morales</p>
            </header>
                <h1>Introducció</h1>
                <p>Aquest estudi es planteja amb la següent hipòtesi: a partir de la música es poden definir característiques de les diferents cultures del món.<br> A partir d'aquesta hipòtesi s'ha iniciat el procés d'extracció de dades de la base de dades d'spotify. La hipòtesi plantejada és que les cultures del món es poden caracteritzar a partir de la seva música.</p>
                <h1>Codi</h1>
                <p>El procés d'obtenció de dades sha realitzat mitjançant l'accés a l'api de desenvolupador de Spotify a través d'un codi de python. El primer pas realitzat per aquesta recolecció de dades es crear una aplicació d'Spotify Dev per poder accedir a l'api. Aquesta aplicació genera un Client ID i un Client Secret, dos claus que introduirem al python y mitjançant diferents mòduls utilitzarem per extreure informació de l'api d'Spotify.</p>
		<img src="Spotify Dev.JPG"  width="1080" height="400">
		<h2>Mòduls</h2>
		<p>Un cop tenim aquestes credencials ja podem començar amb el arxiu de python. Comencem instalant i important els mòduls que necessitarem per l'extracció.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">spotipy</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">json</span>
<span style="color: #f92672">from</span> <span style="color: #f8f8f2">spotipy.oauth2</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">SpotifyClientCredentials</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">time</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">pandas</span> <span style="color: #f92672">as</span> <span style="color: #f8f8f2">pd</span>
</pre></div>
		<p>El primer de tots es la biblioteca de "spotipy", biblioteca de lliure accés creada per Paul Lamere pensada per manipular la api d'Spotify. També farem servir la biblioteca de "json", bàsicament per tenir accés i visualitzar arxius json, que serà el tipo d'arxiu que extraurem de la api. El tercer as preparatori es importar l'intèrpret de les credencials d'Spotify desde el propi mòdul d'Spotipy.
Importem també el mòdul "time" per afegir un temps de pausa a les peticions, en motiu d'evitar el bloqueig per sobresaturació de la api. I per acabar importem el mòdul "pandas" que emprarem per traballar amb datasets i dataframes.</p>
		<h2>Preparació</h2>
		<p>Comencem assignant les dues credencials a dues variables internes. I amb aquestes dues variables i l'ajuda del "SpotifyClientCredentials" aconseguim el "auth_manager".  I mitjançant aquest objecte auth_manager per l'autentificació aconseguim accés a Spotify amb el modul d'Spotipy assignant aquest modul com a "sp".
</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">SPOTIPY_CLIENT_ID</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;89f634cbfb22458fbd2b396dd25496ee&#39;</span>
<span style="color: #f8f8f2">SPOTIPY_CLIENT_SECRET</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;f266a68c3f5f4fc6901091f6f7fb553e&#39;</span>

<span style="color: #f8f8f2">auth_manager</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">SpotifyClientCredentials(SPOTIPY_CLIENT_ID,</span> <span style="color: #f8f8f2">SPOTIPY_CLIENT_SECRET)</span>
<span style="color: #f8f8f2">sp</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">spotipy</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Spotify(auth_manager</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">auth_manager)</span>

<span style="color: #f8f8f2">playlist_ids</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&quot;37i9dQZEVXbO839WGRmpu1&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKPTKrnFPD0G&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbK4fwx2r07XW&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKzoK95AbRy9&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMda2apknTqH&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbLJ0paT1JkgZ&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbL1Fl8vdBUba&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJZGli0rRP3r&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbIZQf3WEYSut&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJPVQvqZqpcM&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMy2EcFg5F9m&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbLp5XoPON0wI&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJVKdmjH0pON&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJHSzlHx2ZJU&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMdvweCgpBAe&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMWDif5SCBJq&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbIZK8aUquyx8&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJ5J1TrbkAF9&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKqiTGXuCOsB&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbLeBcWrdps2V&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMPoK06pe7d6&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKcS4rq3mEhp&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbNM8vS9cIqAG&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKUoIkUXteF6&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbLw80jjcctV1&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbIWlLQoMVEFp&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbNy9tB5elXf1&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbNSiWnkYnziz&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMGcjiWgg253&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbN66FupT0MuX&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJV3H3OfCN1z&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbJ7qiJCES5cj&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbMVY2FDHm6NN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbNvXzC8A6ysJ&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;37i9dQZEVXbKZyn1mKjmIl&quot;</span><span style="color: #f8f8f2">]</span>
<span style="color: #f8f8f2">paises</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&quot;SAU&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;ARG&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;AUS&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;BRA&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;CAN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;CHI&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;COL&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;KOR&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;EAU&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;ECU&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;EGY&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;USA&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;PHI&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;GUA&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;HKG&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;IND&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;IDN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;ISR&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;JAP&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;KAZ&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;DOM&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;MAL&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;MAR&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;MEX&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;NIG&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;NZE&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;PAK&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;PAN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;PER&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;SGP&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;SAF&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;THA&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;TWN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;VEN&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;VNM&quot;</span><span style="color: #f8f8f2">]</span>
</pre></div>
		<p>Un cop tenim accés a l'Api procedim a manualment agafar els id de les playlist que ens interessen. En aquest cas totes les playlists del TOP 50 cançons de cada païs. En aquest codi d'exemple hi ha 35 països fora d'Europa, ja que els països europeus s'han extret amb un codi idèntic però generant un dataset només europeu. Al mateix temps que recolectem les id de les playlist en un altre llista i en el mateix ordre afegim el codi de tres lletres per a cada païs. Hem decidit fer servir aquest codi ja que d'aquesta manera Tableau reconeix els països i pots fer infografies de mapas.</p>
		<h2>Iteració i recolecció</h2>
		<p>Gràcies a la documentació d'spotipy així com a l'analisi d'un json de prova vam poder arribar a veure com accedir a les dades que ens interessaven així com quina era la nomenclatura adequada per accedir-hi. Un cop fet aquests passos previs es moment d'aconseguir les dades definitives.
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">list,</span> <span style="color: #f8f8f2">pais</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">zip(playlist_ids,</span> <span style="color: #f8f8f2">paises):</span>
    <span style="color: #f8f8f2">query</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">sp</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">playlist_items(list,</span> <span style="color: #f8f8f2">fields</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">limit</span><span style="color: #f92672">=</span><span style="color: #ae81ff">100</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">offset</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">market</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None)</span>

    <span style="color: #66d9ef">with</span> <span style="color: #f8f8f2">open(f</span><span style="color: #e6db74">&quot;{pais}-{list}.json&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;w&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">encoding</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39;utf-8&#39;</span><span style="color: #f8f8f2">)</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">f:</span>
        <span style="color: #f8f8f2">json</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">dump(query,</span> <span style="color: #f8f8f2">f,</span> <span style="color: #f8f8f2">ensure_ascii</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">False,</span> <span style="color: #f8f8f2">indent</span><span style="color: #f92672">=</span><span style="color: #ae81ff">4</span><span style="color: #f8f8f2">)</span>
</pre></div>
		<p>I a la variable query li assignem tots els items de la playlist fent servir la playlist ID de cada païs. Per tant per a cada iteració "query" conté tots els items de cada un dels països. Per tant ens interessa generar un json per a cada païs. Per tant creem un json de nom el païs més la playlist ID. I en aques json aboquem tota la query pertanyent a aquell païs.
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">query[</span><span style="color: #e6db74">&#39;items&#39;</span><span style="color: #f8f8f2">]:</span>
        <span style="color: #f8f8f2">song_id</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">i[</span><span style="color: #e6db74">&quot;track&quot;</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;id&quot;</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">track_name</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">i[</span><span style="color: #e6db74">&quot;track&quot;</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;name&quot;</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">features</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">sp</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">audio_features(song_id)</span>
        <span style="color: #f8f8f2">artists_name</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">i[</span><span style="color: #e6db74">&quot;track&quot;</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;album&quot;</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;artists&quot;</span><span style="color: #f8f8f2">]</span>
        <span style="color: #f8f8f2">cantants</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
</pre></div>
		<p>En aquesta primera iteració obtenim uns paràmetres claus. Aconseguim el "ID" de la cançó, el nom de la cançó, el nom de l'artista d'aquesta canço i introduim en una llista tots els "audio_features". Finalment creem una llista buida per als cantants, ja que a la variable d'artists_name i ha més d'un artista en molts casos, i només ens interessa assignar un artista a cada cançó.</p>
Ja hem establert que la query conté els elements d'una playlist. Així que és moment d'extreure aquells elements d'items que ens interessin. Primer creem una llista per volcar les mesures de cada cançó i iterem sobre "items" de "query". Que bàsicament es iterar sobre cada cançó de la playlist, per tant "i" és cada cançó.</p>
Comencem iterant sobre les llistes d'identificadors de playlists i països simultaneament. Aconseguim una llista on cada element de la llista està comprès per l'identificador de la playlist i el codi del seu païs.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">artist</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">artists_name:</span>
            <span style="color: #f8f8f2">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">artist[</span><span style="color: #e6db74">&quot;name&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">cantants</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(a)</span>
</pre></div>
		<p>És per això que tornem a iterar sobre la llista "artists_name" i afegim en una llista tots els cantants per separats. Fet que farà que més endavant poguem escollir quin d'aquests cantants volem assignar a cada cançó.
</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">element</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">features:</span>
            <span style="color: #f8f8f2">dance</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;danceability&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">energy</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;energy&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">key</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;key&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">acousticness</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;acousticness&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">duration_ms</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;duration_ms&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">loudness</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;loudness&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">speechiness</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;speechiness&quot;</span><span style="color: #f8f8f2">]</span>
            <span style="color: #f8f8f2">tempo</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">element[</span><span style="color: #e6db74">&quot;tempo&quot;</span><span style="color: #f8f8f2">]</span>
</pre></div>
		<h2>Generar Dataset</h2>
		<p>A continuació iterem sobre la llista de les "audiofeatures" i a cada element d'aquesta llista li assignem la variable corresponent al seu nom. Les audio_features preseleccionades per aquest estudi son: "danceability", "energy", "key", "acousticness", "duration_ms", "loudness", "speechiness" i "tempo". A les quals les assignem a variables homònimes, que farem servir per introduir totes aquestes mesures i les anteriors en un dataframe.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">df</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DataFrame({</span>
                <span style="color: #e6db74">&quot;danceability&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[dance],</span>
                <span style="color: #e6db74">&quot;artist_name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[cantants[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]],</span>
                <span style="color: #e6db74">&quot;song_id&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[song_id],</span>
                <span style="color: #e6db74">&quot;track_name&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[track_name],</span>
                <span style="color: #e6db74">&quot;key&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[key],</span>
                <span style="color: #e6db74">&quot;energy&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[energy],</span>
                <span style="color: #e6db74">&quot;acousticness&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[acousticness],</span>
                <span style="color: #e6db74">&quot;duration_ms&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[duration_ms],</span>
                <span style="color: #e6db74">&quot;loudness&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[loudness],</span>
                <span style="color: #e6db74">&quot;speechiness&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[speechiness],</span>
                <span style="color: #e6db74">&quot;tempo&quot;</span><span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">[tempo]</span>
            <span style="color: #f8f8f2">})</span>
</pre></div>
		<p>Finalment creem el daframe fent servir totes les "audio_features" esmentades més el "song_id", "track_name" i el primer artista de la llista d'artistes de la cançó.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">		<span style="color: #f8f8f2">llista</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(df)</span>
    <span style="color: #f8f8f2">time</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">0.2</span><span style="color: #f8f8f2">)</span>
</pre></div>
		<p>Un cop tenim el dataframe l'afegim a la llista, on s'aniràn afegint els dataframes de cada cançó a mesura que avançi la iteració. La iteració de "query""items" la tanquem amb un time sleep de 0.2 segons per no saturar la api.

Tenim tots els dataframes en una llista, però ara ens fa falta concatenar aquesta llista per aconseguir un dataset utilitzable.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"> <span style="color: #f8f8f2">dataset</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">concat(llista)</span>
    <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(dataset)</span>
    <span style="color: #f8f8f2">dataset</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">to_csv(f</span><span style="color: #e6db74">&quot;dataset-{pais}-{list}.csv&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">False)</span>
</pre></div>
		<p>Concatenem aquesta llista en la variable dataset i exportem aquest dataset en un csv de nom igual al json previament generat, amb el nom del païs i el id de la playlist. Això ens dona 35 csvs individuals per cada païs, els quals el seguent pas serà ajuntar tots aquests csvs en un csv global. </p>
		<h2>Merging CSVS</h2>
		<p>Per concatenar tots aquests datasets generats necessitarem un nou mòdul, la biblioteca anomenada "glob". I la ja coneguda "pandas"</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">glob</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">pandas</span> <span style="color: #f92672">as</span> <span style="color: #f8f8f2">pd</span>
</pre></div>
		<p>És important tenir tots els arxius csv en la mateixa carpeta, ja que mitjançant la nomenclatura podrem accedir a tots aquests arxius sense haver d'anomenar-los individualment.</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">file_list</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">glob</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">glob(</span><span style="color: #e6db74">&quot;*.csv&quot;</span><span style="color: #f8f8f2">)</span>

<span style="color: #f8f8f2">df_concatenated</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DataFrame()</span>

<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">file</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">file_list:</span>
    <span style="color: #f8f8f2">df</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">read_csv(file)</span>
    <span style="color: #f8f8f2">df_concatenated</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">concat([df_concatenated,</span> <span style="color: #f8f8f2">df])</span>
</pre></div>
		<p>Fent servir el la funció del glob.glob llegim i emmagatzamem en una llista tots els datasets amb format csv del directori. A continuació creem un Dataframe buit on emmagatzarem els datasets concatenats i iterem sobre cada arxiu de la llista de datasets creada anteriorment.

Bàsicament llegim el csv, l'assignem a una variable i anem concatenant cada arxiu al dataframe buit previament creat. I finalmente creem un nou csv on tenim tot merged.
</p>
		<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">df_concatenated</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">to_csv(</span><span style="color: #e6db74">&quot;concatenated_file_totjunt.csv&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">False)</span>
</pre></div>
		<p>Tot aquest codi es pot consultar en el seguent arxiu python: <a href="https://github.com/Aleksandeeeer/ApuntsPython/blob/main/SpotipyFinal/main.py">aqui</a>
	<!-- Fi Fragment de codi -->
    <h2>Europa i mundial</h2>
    <p>Tots aquests passos es van realitzar primerament amb uns 20 països europeus, generant un dataset idèntic al dataset concatenat mundial pero amb europa. I aquest procés de merging es va emprar entre aquests dos datasets generals generant un dataset total Europa+Mundial. Per tant podem dir que tenim un dataset Europeu, un dataset fora d'europa i un dataset Mundial. On el dataset mundial comprèn un total de 57 països.</p>
	<h2>Grapho amb Gephi</h2>
	<p>Un cop generat tot això ja esmentat vam decidir generar un dataset especial per poder tractar amb gephi i generar un grapho de relacions entre països i artistes.</p>
	<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">pandas</span> <span style="color: #f92672">as</span> <span style="color: #f8f8f2">pd</span>

<span style="color: #f8f8f2">df</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">read_csv(</span><span style="color: #e6db74">&quot;concatenated_file_mundial.csv&quot;</span><span style="color: #f8f8f2">)</span>

<span style="color: #f8f8f2">graph</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>

<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">item,</span> <span style="color: #f8f8f2">row</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">df</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">iterrows():</span>
    <span style="color: #f8f8f2">source</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">row[</span><span style="color: #e6db74">&quot;artist_name&quot;</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">target</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">row[</span><span style="color: #e6db74">&quot;pais&quot;</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">tupla</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(source,</span> <span style="color: #f8f8f2">target)</span>
    <span style="color: #f8f8f2">graph</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(tupla)</span>
</pre></div>
	<p>Agafem el csv general i el convertim en un dataframe, creem una llista buida per emmagatzemar les tuples resultants i iterem sobre les files del dataframe.

Agafem les dues variables de "artist_name" i "pais" i les assignem a les variables de "source" i "target" respectivament. Seguidament creem una tupla amb aquestes dues variables i les anem afegint a la llista de tuples.</p>
	<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">final</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pd</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DataFrame(graph,</span> <span style="color: #f8f8f2">columns</span><span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&quot;source&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;target&quot;</span><span style="color: #f8f8f2">])</span>
<span style="color: #f8f8f2">final</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">to_csv(</span><span style="color: #e6db74">&quot;grapho_mundial.csv&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span> <span style="color: #f8f8f2">False)</span>
</pre></div>
	<p>El pas final serà convertir en un dataset aquesta llista de tuples i exportar-ho en un csv. Igual que hem fet amb els anteriors datasets generem un dataset per Europa, un per fora d'Europa i un mundial.

Tot aquest codi es accessible <a href="https://github.com/Aleksandeeeer/ApuntsPython/blob/main/SpotipyFinal/graphgephi.py">aqui</a>
</p>
	<h2>Datasets</h2>
	<p>Tots els datasets son accessibles en el seguent repositori de github: <a href="https://github.com/Aleksandeeeer/ApuntsPython/tree/main/SpotipyFinal">aqui</a>
</p>
	<!-- Ejemplo de codigo de Grafico incrustado-->
    <h1>Anàlisis de les Dades</h1>
    <p>Abans de començar amb l’analisi de les dades i els seus gràfics es important comentar el perquè de la selección dels països. Bàsicament nosaltres no hem fet cap distinció, hem agafat totes les playlists de top 50 cançons de cada païs que Spotify genera. Per tant els països que no están en aquests gràfics son per que no tenen TOP 50 cançons, tenint una mostra final de 57 països de tot el món.<br><br>
La primera intenció d'aquesta extracció de dades i creació de conjunt de dades era aconseguir treure a la llum i analitzar totes aquestes mesures ocultes que té Spotify, mesures com ara quin és el grau de ballable que té una cançó, o com d'acústica és, és positiva o negativa, entre altres mesures. La intenció d'això era establir i observar patrons entre els gustos musicals de diferents països i regions. Arribant fins i tot a plantejar la possibilitat d'establir relacions entre aquests patrons i resultats amb les diferències culturals entre regions del món i la seva gent.<br><br>
Així doncs, aquest anàlisi s'ha basat sobretot en relacionar països i regions segons els seus gustos musicals, observar anomalies i saber si les cançons més escoltades d'una regió són representatives d'estereotips d'aquests països. Tenint en compte l'objecte d'estudi i les dades en les quals ens basem, la nostra intenció era també la curiositat, ja que són mesures sobre les quals no sabem en quins algoritmes es basa Spotify per determinar-les i, per tant, tenim curiositat per saber com qualificarà les cançons i els països. Sent la nostra principal hipòtesi el fet que les mesures i patrons seran similars entre països que comparteixin la mateixa llengua.
</p>
    <h2>Ballabilitat</h2>
    <div class='tableauPlaceholder' id='viz1686928047683' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;RB&#47;RB96D74Q2&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;RB96D74Q2' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;RB&#47;RB96D74Q2&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1686928047683');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.5)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>Comencem analitzant la primera d'aquestes mesures, la ballabilitat. La mesura que mesura entre 0 i 1 el quan de ballable és una cançó. Essent 0 res ballable i 1 tot el contrari. La primera observació que podem fer d’aquest gràfic son els extrems, per una banda tenima  Indonesia com el país menys ballable, on les seves cançons més escoltades tenen el pitjor coeficient de dansabilitat dels 57 països analitzats. Per altre banda el país més ballarí segons Spotify és Ecuador. Seguint encara analitzant països aïllats i anomalies el grup s’ha vist sorprès per tres resultats que han trastocat les nostres hipòtesis inicials. Els baixos coeficients de tant la Índia com Corea del sud. Un país com la Índia que vist des de fora i també en base en el que ens arriba com son les pel·lícules de Bollywood on les cançons venen sempre acompanyades de coreografies. És per això que veure a la Índia a la part baixa de l’espectre es sorpresiu, així com ho és que ho estigui Corea, ja que de forma similar el que ens arriba musicalment és el K-Pop sempre acompanyat de coreografies. I finalment tenim la rara anomalia del baix coeficient de Brasil, un país conegut per la samba, la festa, el carnaval...<br><br>
Deixant de banda anomalies voldríem ressaltar un patró i tendència que s’observa clarament en el gràfic. El fet de que tots els països llatinoamericans tinguin coeficients similars entre ells i aquests coeficients siguin els majors en quant a ballabilitat. De fet podem agrupar a Espanya en aquest grup, ja que té un coeficient molt similar. Veient això podem afirmar que hi ha dos factors principals que estan influint en aquesta agrupació. Un factor cultural i un factor d’idioma. Aquest fet confirma la nostra hipòtesis inicial.<br><br>
L’altre conjunt observable i que val la pena comentar és el fet de que el nord i est d’europa compta amb uns coeficients baixos, fet res sorprenent ja que encaixa amb la imatge que projecten aquests països a l’exterior.
</p>
    <h2>Tempo</h2>
    <div class='tableauPlaceholder' id='viz1686927754048' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;PM&#47;PMTG3GTT6&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;PMTG3GTT6' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;PM&#47;PMTG3GTT6&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1686927754048');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.4)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>En relació a aquesta mesura hem decidit analitzar altres mesures per saber si hi ha alguna relació entre les pròpies mesures, com per exemple el tempo. És el tempo d’una cançó directament proporcional a la ballabilitat? Que té en compte Spotify per determinar aquests coeficients?<br><br>
Tot i així un cop analitzem el tempo veiem que no podem extreure cap conclusió, es una mesura bastant arbitrària i no ens ajuda a establir una relació entre el tempo d’una cançó i quan de ballable és.
</p>
    <h2>Energy</h2>
    <div class='tableauPlaceholder' id='viz1686927888029' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5N&#47;5NMJN9NNY&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;5NMJN9NNY' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;5N&#47;5NMJN9NNY&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1686927888029');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.5)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>En canvi quan analitzem la mesura de “energy” si veiem com hi ha una clara relació entre el primer gràfic que hem analitzat i aquest. Els països amb una alta ballabilitat compten ara amb un coeficient d’energia elevat. El que si ha canviat és en països que tenien la ballabilitat baixa però ara tenen la energia alta, com seria el cas de Brasil i la major part d’Europa. En el cas del sud d’asia seguim veient una energia baixa que explica la poca ballabilitat, i ens torna a sorprendre el baix coeficient d’India. En el cas concret d’america la correlació entre l’energia i la ballabilitat és total a excepció de Brasil com ja hem comentat.<br><br>
            D’aquest tercer gràfic és on podem veure més clarament la divisió per regions i àrees geogràfiques. Ja que estan agrupats amb coeficients similars països adjacents i no hi ha excepcions entre països d’una regió.
    <h2>Acústica</h2>
    <div class='tableauPlaceholder' id='viz1686928323154' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;QR&#47;QRY927FXX&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;QRY927FXX' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;QR&#47;QRY927FXX&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1686928323154');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.5)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>En canvi quan analitzem l’acústica de les cançons veiem que els resultats son totalment diferents al gràfic anterior. De podem establir una correlació inversa entre el coeficient de ballabilitat, l’energia i el coeficient acústic. Establint que  quan menys acústica és una cançó més ballable i enèrgica és.<br><br>
L’acústica consisteix en el grau d’instruments elèctrics que formen part de la cançó, sent un nivell baix d’acústica una música més artificial i eléctrica. Per tant aquesta mesura ens permet veure el tipus de música que agrada a cada païs, i com aquest tipus de música es considerada per Spotify
</p>
    <h2>Duració</h2>
    <div class='tableauPlaceholder' id='viz1686936181586' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;MJ&#47;MJQ22GKXC&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;MJQ22GKXC' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;MJ&#47;MJQ22GKXC&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1686936181586');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.5)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>La última mesura que s’ha decidit analitzar ha estat la duració de les cançons, bàsicament per acabar de segmentar i agrupar el mapa mundi en patrons i regions. <br><br>
Ja que aquest mapa és pràcticament idèntic al mapa d’energia a excepció d’Estats Units. Aquest gràfic també ens permet visualitzar com les cançons més curtes solen ser menys acústiques i més ballables.
</p>
    <h2>Conclusió Audio Features</h2>
    <p>Finalment les mesures del dataset de loudness, speechiness i la key de la cançó no han estat fetes servir degut a que els resultats eren massa dispersos o eren molt similars a gràfics ja obtinguts.<br><br>
Gràfics amb els quals hem pogut extreure una sèrie de conclusions. Bàsicament i de forma més general hem pogut agrupar regions i països de forma clara segons els seus gustos musicals. Fent aquesta distinció musical en base a característiques internes d’Spotify com son la ballabilitat o el tempo.<br><br>
Les principals conclusions territorials son dos. I és que a grans trets el món està dividit en dos maneres de viure la música. Per una banda tenim a Sud-Amèrica i Europa, més concretament Llatinoamèrica i el sudest d’Europa. I per l’altre banda tenim tot el sud d’Asia i orient mitjà.<br><br>
En el cas del continent Africà les dades de les que disponem son massa escasses i no podem fer un anàlisis representatiu. A continuació relacionarem els països de forma molt més concreta fent servir un grapho de gephi emprant com a dades els artistes i els països. Per veure si aquest anàlisis que hem fet mitjançant tableau es veu reflexat en el grapho, arribant a entendre i veure els possibles motius i connexions d’aquests patrons ja comentats.<br><br>
</p>
	<h1> Anàlisi de les relacions entre països </h1>
	<p>Per a seguir amb auest estudi hem analitzat les relacions entre els diferents països. Per a fer-ho, hem utilitzat un dataset adaptat a grafs amb source: cantant i target: país. I així per a totes les cançons de tots els tops 50.<br><br>
Un cop preparat el dataset l'hem analitzat amb Gephi. Hem combinat diferents distribucions per ajustar al màxim el resultat. Entre els algoritmes utilitzats destaquen ForceAtlas2, ajuste de etiquetas i Noverlap.</p>
	<img src="graf_final.jpg.jpg"  width="900" height="750">
	<h2>Hi ha algun país "outsider"? </h2>
	<p>Com veiem al gràfic, hi ha dos països que no tenen relació amb cap altre nació. Aquests són Turquia i Brasil.</p>
	<h4>Per què passa aquest fet?</h4>
	<p>Una vegada analitzats els dos territoris que no tenen relació amb cap altre país, hem trobat que comparteixen certs trets característics: <br> En primer lloc, són dos països grans en relació als seus veïns. Aquest fet es combina amb dues cultures molt arrelades i antigues. <br> En segon lloc, són dos països amb llenguatge propi únic (cal tenir en compte que Portugal no apareix a les llistes d'Spotify)<br> Finalment, cal destacar que són dos territoris governats per partits afins a l'extrema dreta. Creiem que aquest fet pot tenir relació amb el tancament a noves cultures i el potenciament del talent propi.</p>
	<h2> Què volen dir els colors? </h2>
	<p>Els colors indiquen modularitat. La modularitat a Gephi indica l'estructura interna d'un graf, revelant agrupacions de nodes altament interconnectats i diferents comunitats dins d'un sistema complex.<br> D'aquesta manera, podem apreciar vàries comunitats de països altament connectats. Expliquem les principals: <br><br> 
	<b>Verd clar:</b> Agrupa països de l'Àsia Oriental. Tailàndia, Japó, Vietnam, Korea, Hong Kong, Singapur i Taiwan.</p>
	<p><b>Rosa: </b> Països relacionats amb Rússia. Bielorrússia, Kazakhstan i Ucraïna.</p>
	<p><b>Blau cel: </b> El cas més clar. Espanya i LATAM. </p>
	<p><b>Lila: </b> Països de parla anglesa. Inclou nacions com Nova Zelanda, Austràlia, Emirats Àrabs, Gran Bretanya, Estats Units, ... </p>
	<p><b>Taronja: </b> Països nòrdics. Suècia, Dinamarca i Noruega.</p>
	<p><b>Gris: </b> Països amb poques relacions, o relacions amb comunitats diferents. Inclou Romania, Nigèria, Hongria, entre d'altres.</p>
	
	<h2>Qui és el cantant amb més connexions?</h2>
	<p>L'artista amb més connexions és Miley Cyrus, amb un total de 32 connexions. Té la canço més escoltada en el que portem de 2023 (Flowers) i va treure un àlbum al març. </p>
	
	<h2>Quina és la comunitat més aïllada?</h2>
	<p>La comunitat més aïllada la formen els països castellanoparlants. Mostrada amb el color blau, és la comunitat que més destaca. Els països comparteixen gran quantitats d'artistes que no apareixen a cap zona més. <br>Per exemple, els següents artistes apareixen a tots els països del grup blau: Yandel, Manuel Turizo, Eladio Carrión, Ozuna, Feid, Karol G, Yng Lucas, Eslabón Armado, Grupo Frontera i Shakira</p>
	
	<h2>Quina és la comunitat més central?</h2>
	<p>El gràfic mostra clarament una comunitat lila al centre. Aquesta comunitat és la de països de parla anglesa, i està connectada amb tota la resta de comunitats. <br>La componen països com Malàisia, Estats Units o Suïssa. Tot i estar dins la mateixa comunitat, els països estan situats a prop dels seus territoris veïns. Per exemple, Suïssa està a prop d'Àustria i Alemanya (grisos); Malàisia toca amb la comunitat asiàtica (verd); i USA connecta amb Mèxic i els països castellano-parlants.</p>
            <footer>
			<hr>
			<p>
               Alexander Morales i Miquel Coll
            </p>

			</footer>
		</div>
	</body>
</html>
